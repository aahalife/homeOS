# fly.toml for HomeOS Workflows Worker (Temporal)
#
# This is a background worker that polls Temporal for tasks.
# It must stay running to process workflows.
#
# Development: Single small instance
# Production: Scale with: fly scale count 2 --app homeos-workflows
#
app = 'homeos-w6ef6q-workflows'
primary_region = 'iad'

[build]
  image = "bharathsud123/homeos-workflows:latest"

[env]
  NODE_ENV = "production"
  TASK_QUEUE = "homeos-workflows"

# No HTTP service - this is a background worker
[processes]
  worker = "node dist/worker.js"

[[vm]]
  memory = '512mb'              # Reduced for dev (1gb for prod)
  cpu_kind = 'shared'
  cpus = 1
